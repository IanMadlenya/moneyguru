Основы moneyGuru
================

moneyGuru основан на принципе `двойной записи<https://ru.wikipedia.org/wiki/Двойная_запись>`__. Ядро системы - **транзакция**, которая представляет собой перемещение денег с одного счета на другой в конкретный период. Транзакция состоит из 2 или более записей на 2 или более счетов, в сумме по всем строкам имеющая баланс (т.е. ноль). С любого счета можно перевести деньги на любой другой счет. Этим удобно пользоваться, когда дело доходит до :doc:`управления финансами <cash>`. В принципе, больше особенно нечего рассказать об основах системы. Сложности могут появится, если в учете участвуют несколько валют; подробнее об этом описано на странице :doc:`валюты <currencies>`.

Вкладки и представления
--------------

moneyGuru позволяет показать разные представления данных (одно из основных показано ниже), с помощью которых
вы управляете документом в moneyGuru. Эти представления реализованы в виде вкладок главного окна. Новую вкладку
можно открыть с помощью |cmd|\ T, закрыть с |cmd|\ W, перемещаться по открытым вкладкам - |cmd_shift|\ ←→. Если вы
открыли счет кнопкой со стрелкой |basics_show_account_arrow| , новая вкладка откроется с этим счетом.

Диапазон дат
--------------

Выбранный диапазон дат (период) действует для программы в целом. Все, что вы видите во вкладках (представлениях), действительно 
только для выбранного периода. К примеру, если выбрано "Янв 2010 - Дек 2010", то все, что вы видите в представлениях, 
касается периода с 01.01.2010 по 31.12.2010. Этот период настраивается виджетом:

|basics_date_range|

Есть 7 типов периода:

#. **Месяц:** Начинается первым днем месяца и оканчивается последним днем этого месяца.
#. **Квартал:** Начинается в первый день квартала (3 месяца) и оканчивается последним днем этого квартала.
#. **Год:** Начинается первым днем года и оканчивается последним днем этого года.
#. **С начала года:** Начинается в первый день *текущего* года и оканчивается *сегодня*. Используйте этот диапазон если хотите чтобы moneyGuru показала текущую ситуацию (без учета бюджета и запланированных транзакций).
#. **Текущий год:** Этот диапазон показывает *один год*, но, в отличие от календарных лет, он использует настройку "Кол-во предшествующих месяцев в текущем году" чтобы вычислить конец диапазона, а потом вычесть из этой даты один год.
#. **Все транзакции:** Этот диапазон начинается с даты самой первой транзакции в документе и заканчивается сегодня + кол-во предшествующих месяцев (смотри: Текущий год).
#. **Произвольный интервал:** Когда вы выберете этот диапазон, moneyGuru запросит у вас дату начала и окончания, и эти даты станут границами диапазона.

Для "навигационных" периодов (Месяц, Квартал, Год), можно использовать стрелки для выбора предыдущего/следующего периода (или горячие клавиши |cmd_opt|\ [ и |cmd_opt|\ ]). Также есть горячие клавиши для выбора типа диапазона (|cmd_opt|\ 1-7). Вернуться к текущему периоду выбранного диапазона дат можно клавишами |cmd_opt|\ T.

Когда выбран произвольный интервал, вы также можете сохранить введенный диапазон в один из 3 доступных слотов. Когда вы это сделаете, сохраненный диапазон появится в меню и может быть быстро вызван.

Тонкая красная линия
-----------------

Вся информация в moneyGuru показывается в зависимости от выбранного периода. Но интереснее, когда период оканчивается будущей датой. Если у вас есть запланированные транзакции или настроен бюджет, то цифры и графики, которые вы увидите, будут включать их. В графиках будет четкое разграничение между прошлым и будущим. Прошлое показывается зеленым, будущее - серым, а тонкая красная линия будет между ними. Посмотрев на серую часть графика, вы увидите вещи, которые еще не произошли. Ваш собственный капитал в балансе будет подсчитан с учетом запланированных транзакций и бюджетов. Но иногда вы просто хотите знать вашу текущую финансовую ситуацию - для этого существует диапазон "С начала года" (|cmd_opt|\ 4).

Настройки видимости
------------------

На некоторых вкладках присутствуют графики и диаграммы, но на всех из них есть таблицы. Вы можете управлять
видимостью этих элементов с помощью кнопок, расположенных внизу главного окна. Если щелкнуть на кнопке видимости
колонок, вы получите список всех настраиваемых колонок для текущего режима просмотра. В этом списке
вы можете настроить видимость нужных вам колонок.

Чистая прибыль и Прибыли/Убытки
---------------------------

|basics_net_worth|

Представления Чистая прибыль и Прибыли/Убытки служат основой для управления счетами и получения данных о вашем финансовом положении. Они очень похожи.

**Ведомость:** Слева вверху находится "ведомость" по всем счетам с итогами по группам счетов. Итоги всегда отображаются в местной валюте. Здесь вы также можете :doc:`добавлять, изменять и удалять <editing>` счета.

**Показать счет:** У каждого счета есть маленькая стрелка |basics_show_account_arrow|. Вы можете кликнуть по ней, чтобы открыть выбранный счет в Просмотре счета. Также можно выбрать счет и нажать |cmd|\ →.

**Исключение счета:** Вы можете "исключить" счета, кликнув на иконку |basics_account_out|, или нажимая |cmd_shift|\ X. Исключенные счета не участвуют в итогах и графиках.

**Круговая диаграмма:** Справа есть две круговые диаграммы, показывая долю каждого счета в общем итоге по каждому типу. Если у вас есть группы счетов, вы можете свернуть одну из этих групп в ведомости чтобы иметь сгруппированнные значения по счетам в диаграмме. Например, если у вас есть группа счетов "Автомобиль" с несколькими счетами в ней, вы можете свернуть группу в ведомости чтобы получить  "Автомобиль" как одну часть диаграммы.

**График:** График внизу показывает изменение общей статистики со временем.

**Колонки:** В ведомостях есть разные наборы колонок:

* **Баланс:**

    * **Номер счета:** Опциональный параметр. Смотрите страницу :doc:`редактирование <editing>`.
    * **Начало:** Баланс счета на начало периода. Включает запланированные транзакции, но без учета бюджетов.
    * **Окончание:** Баланс счета на конец периода.
    * **Изменение:** Разница между Началом и Окончанием.
    * **Изменение %:** Разница в процентах между Началом и Окончанием.
    * **В бюджете:** Сумма в бюджете (для каждого счета это **цель**) оставшаяся от запланированной в выбранном периоде. Это означает, что, если ваши бюджеты соответствуют действительности, то Окончание + В бюджете будет вашим актуальным балансом в конце периода.
    
* **Прибыли и Убытки:**

    * **Номер счета:** то же самое, что и в Балансе.
    * **Текущий:** Движение денег по счету в текущем периоде.
    * **Прошлый:** Движение денег по счету в прошлом периоде. К примеру, если выбран месячный диапазон, в колонке Прошлый будет показано движение денег за прошлый месяц. С начала года - это специальный случай и в нем колонка Прошлый показывает движение денег за последний год.
    * **Изменение и Изменение %:**  то же самое, что и в Балансе.
    * **В бюджете:** Сумма в бюджете, привязанная к этому счету, и оставшаяся от запланированной в выбранном периоде. Это означает, что, если ваши бюджеты соответствуют действительности, то Текущий + В бюджете будет вашим актуальным движением денег в конце периода.

Транзакции
------------

|basics_transactions|

В представлении Транзакции показываются все транзакции документа в текущем периоде. Здесь вы можете :doc:`добавлять, изменять или удалять <editing>` транзакции. В этом представлении наиболее удобно добавлять транзакции пакетом (это если у вас есть стопка счетов и квитанций, чтобы добавить, например). **Сумма** содержит значение , которое переводится со счета на счет транзакцией. **Откуда** и **Куда** содержат названия счетов (категорий), задействованных в транзакции (если это разделенная транзакция, то названия вводятся через запятую). Эти три колонки означают, что "Эта транзакция переводит **Сумму** из **Откуда** и отправляет ее в **Куда**". Например, если **Откуда** это "Расчетный счет" и  **Куда** это "Продукты", то деньги взяты с Расчетного счета и потрачены на "Продукты". Для дохода **Откуда** может быть "Зарплатой", а **Куда** - к примеру, "Зарплатной картой".

Над списком транзакций есть **панель отбора**, позволяющая отфильтровать только нужные типы транзакций.

* **Income:** - Показать только операции, влияющие, по крайней мере, на один счет доходов.
* **Expense:** - Показать только операции, влияющие, по крайней мере, на один счет расходов.
* **Transfer:** - Показать только операции, влияющие, по крайней мере, на два счета активов или обязательств.
* **Unassigned:** - Показать только операции, имеющие как минимум одну не назначенную запись.
* **Reconciled:** - Показать только операции, имеющие как минимум одну сверенную запись.
* **Not Reconciled:** - Показать только операции, имеющие не сверенные записи.

Ячейки **Откуда** и **Куда** имеют |basics_show_account_arrow| справа. Вы также можете кликнуть по ней, чтобы показать счет, указанный в ячейке (для разделенных транзакций будет указан не один счет, но откроется только первый).

Колонка **Дата изменения** показывает время, в которое транзакция была отредактирована. Это значение
полезно для нахождения ошибок, которые вы можете сделать при редактировании. Если итоги "не идут" и
вы не знаете почему, отсортируйте траназакции по Дате изменения и дважды проверьте, не сделали ли вы
ошибку в недавних правках.

Счет
-------

|basics_account|

Это представление показывает транзакции *только по конкретному счету*. Вы можете его открыть, кликнув на |basics_show_account_arrow| в других представлениях. Это представление выводит транзакции так же, как в представлении Транзакции, но при этом только те транзакции, которые соответствуют выбранному счету. Только вместо колонок **Откуда** и **Куда**, там будет колонка **Перевод** (*счет-корреспондент* транзакции). А колонка **Сумма** разделится на колонки **Увеличение** и **Уменьшение**. К примеру, если выбран Расчетный счет и в колонке **Перевод** стоит "Продукты", а в колонке **Уменьшение** стоит "42", это значит, что 42 руб. взяты с Расчетного счета и потрачены на Продукты. Если просматриваемый счет - это Актив или Обязательство, то появится еще колонка **Баланс**, которая показывает текущий баланс по счету. График ниже показывает баланс по счету за каждый день периода. Если просматриваемый счет - это Доход или Расход, то будет показана диаграмма, похожая на такую же во вкладке Прибыли и Убытки.

В просмотре счета также есть поле отбора, которое схоже по поведению на поле отбора в Транзакциях, но с небольшими отличиями.

* **Increase:** показывает только те записи, у которых есть нужное значение в колонке "Увеличение".
* **Decrease:** показывает только те записи, у которых есть нужное значение в колонке "Уменьшение".
* **Transfer:** показывает только те записи, которые являются частью транзакции, соответствующей как минимум двум счетам активов или обязательств.
* **Unassigned:** показывает только не назначенные ни одному счету записи.
* **Reconciled:** показывает только сверенные записи.
* **Not reconciled:** показывает только несверенные записи.

Кнопка *Сверка* (доступная только для счетов активов или обязательств) позволяет вам переключить режим :doc:`сверки <reconciliation>` (включено и выключено).

В ячейке **Перевод** есть маленькая стрелка |basics_show_account_arrow| справа. Вы так же можете кликнуть на эту стрелку, чтобы перейти к просмотру выбранного счета/категории. В отличие от стрелки в Транзакциях, эта позволяет *циклически переходить* по выбранным счетам. 

В зависимости от выбранного периода может появиться запись **Предыдущий баланс** сверху таблицы. Эта запись, так же как в любой банковской выписке, показывает баланс счета с начала выбранного периода.

Главная книга
--------------

В этом представлении записи по всем счетам для выбранного периода показываются в одном окне. Их вид такой же, как при просмотре записей по любому счету. Это представление главным образом нужно для отчетов.

Отбор
---------

Поле отбора на верхней панели позволяет просматривать транзакции, соответствующие 
тому, что вы набрали в этом поле. Просто напишите в нем что-нибудь и нажмите ввод. 
Только транзакции, в которых хотя бы одно из полей (описание, контрагент, счет и т.п.) соответствует
тому, что вы набрали, будут показаны. Если вам нужно найти только что-то определенное, 
в поле отбора наберите наименование поля перед запросом, например, "payee: Apple". 
Возможные префиксы:

* description - для поля "Описание"
* payee - для поля "Контрагент"
* checkno - для поля "Номер чека"
* memo - для поля "Заметка"
* account - для поля "Счет"
* group - для поля "Группа"
* amount - для поля "Сумма"

Префиксы счета и группы такие из-за того, чтобы вы могли искать множество значений, разделяя
наименование счета/группы запятой. К примеру, запрос "account: Visa, Mastercard" приведет к 
отбору транзакций только по счетам Visa или Mastercard.

Что видишь, то и напечатаешь
--------------------------------------

В moneyGuru вы можете распечатать все, что открыто в данный момент в любом представлении. Хотите отчет по списку транзакций за последний год? Просто установите текущий диапазон дат, равный прошлому году, перейдите на вкладку Транзакции и нажмите |cmd|\ P. moneyGuru автоматически подстроит размер колонок согласно их содержимому, чтобы поместить больше данных на странице.

.. |basics_show_account_arrow| image:: image/basics_show_account_arrow.png
.. |basics_account_out| image:: image/basics_account_out.png
.. |basics_date_range| image:: image/basics_date_range.png
.. |basics_net_worth| image:: image/basics_net_worth.png
.. |basics_transactions| image:: image/basics_transactions.png
.. |basics_account| image:: image/basics_account.png
